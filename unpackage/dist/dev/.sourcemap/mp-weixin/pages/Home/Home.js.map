{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/Administrator/Desktop/乱七八糟/TakeTaxi/pages/Home/Home.vue?fb6f","webpack:///C:/Users/Administrator/Desktop/乱七八糟/TakeTaxi/pages/Home/Home.vue?9a08","webpack:///C:/Users/Administrator/Desktop/乱七八糟/TakeTaxi/pages/Home/Home.vue?0424","uni-app:///pages/Home/Home.vue?vue&type=script&lang=ts&"],"names":["createPage","Page"],"mappings":"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","file":"pages/Home/Home.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/Home/Home.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./Home.vue?vue&type=template&id=2bc86734&\"\nvar renderjs\nimport script from \"./Home.vue?vue&type=script&lang=ts&\"\nexport * from \"./Home.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/Home/Home.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./Home.vue?vue&type=template&id=2bc86734&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\ts-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./Home.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\ts-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./Home.vue?vue&type=script&lang=ts&\"","\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nimport {\r\n  Component,\r\n  Vue,\r\n  Watch,\r\n  Mixins\r\n} from 'vue-property-decorator';\r\n\r\nimport VueMixins from '../../mixins/VueMixins.ts';\r\nimport MapAPI from '../../static/api/mapAPI';\r\n\r\n@Component({\r\n  name: 'Home'\r\n})\r\nexport default class Home extends Mixins(VueMixins) {\r\n  title = '四川大学华西医院';\r\n  distance = 0; //\"距离\"\r\n  latitude = 39.909; // 默认定在首都\r\n  longitude = 116.39742;\r\n  scale = 12; // 默认16\r\n  markers = [];\r\n  markerHeight = 30;\r\n  doorAddress = []; //门店地址\r\n\r\n  //路线\r\n  routePolyline;\r\n\r\n  // 拒绝授权后，弹框提示是否手动打开位置授权\r\n  openConfirm() {\r\n    return new Promise((resolve, reject) => {\r\n      uni.showModal({\r\n        title: '请求授权当前位置',\r\n        content: '我们需要获取地理位置信息，为您推荐附近的美食',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            uni.openSetting()\r\n                .then((res) => {\r\n                  if (res[1].authSetting['scope.userLocation'] === true) {\r\n                    resolve(); // 打开地图权限设置\r\n                  } else {\r\n                    reject();\r\n                  }\r\n                });\r\n          } else if (res.cancel) {\r\n            reject();\r\n          }\r\n        },\r\n      });\r\n    });\r\n  };\r\n\r\n  // 彻底拒绝位置获取\r\n  rejectGetLocation() {\r\n    uni.showToast({\r\n      title: '你拒绝了授权，无法获得周边信息',\r\n      icon: 'none',\r\n      duration: 2000,\r\n    });\r\n  };\r\n\r\n  //进行经纬度转换为距离的计算\r\n  Rad(d) {\r\n    return d * Math.PI / 180.0; //经纬度转换成三角函数中度分表形式。\r\n  }\r\n\r\n  //功能描述:计算距离，参数分别为第一点的纬度，经度；第二点的纬度，经度默认单位km\r\n  getMapDistance(lat1, lng1, lat2, lng2) {\r\n    let radLat1 = this.Rad(lat1);\r\n    let radLat2 = this.Rad(lat2);\r\n    let a = radLat1 - radLat2;\r\n    let b = this.Rad(lng1) - this.Rad(lng2);\r\n    let s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a / 2), 2) +\r\n        Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)));\r\n    s = s * 6378.137; // EARTH_RADIUS;\r\n    s = Math.round(s * 10000) / 10000; //输出为公里\r\n    //s=s.toFixed(2);\r\n    return s;\r\n  }\r\n\r\n  // //获取当前位置并定位\r\n  // openMap(lon, lat) {\r\n  //   console.log('获取经纬度ssssfff', lon, lat);\r\n  //   uni.getLocation({\r\n  //     success: res => {\r\n  //       // res.latitude=lat;\r\n  //       // res.longitude=lon;\r\n  //       console.log('location success', parseFloat(lat), parseFloat(lon));\r\n  //       uni.openLocation({\r\n  //         latitude: parseFloat(lat),\r\n  //         longitude: parseFloat(lon),\r\n  //         scale: 18\r\n  //       });\r\n  //     }\r\n  //   });\r\n  // };\r\n\r\n  getList() {\r\n    console.log('获取周围美食');\r\n  };\r\n\r\n  // 确认授权后，获取用户位置\r\n  getLocationInfo() {\r\n    debugger\r\n    let locationInfoPromise = MapAPI.getLocation();\r\n    let getTargetByAddressPromise = MapAPI.getPositionInfoByAddress();\r\n\r\n    Promise.all([locationInfoPromise, getTargetByAddressPromise])\r\n        .then(res => {\r\n          debugger\r\n        });\r\n\r\n    // uni.getLocation({\r\n    //   type: 'gcj02',\r\n    //   success: (res) => {\r\n    //     // 暂时\r\n    //     this.longitude = res.longitude; //118.787575;\r\n    //     this.latitude = res.latitude; //32.05024;\r\n    //     console.log('获取当前的用户经度', this.longitude);\r\n    //     console.log('获取当前的用户纬度', this.latitude);\r\n    //     // let long = 0;\r\n    //     // let lat = 0;\r\n    //     //小数点保留六位  经度\r\n    //     // if (this.longitude.toString()\r\n    //     //     .indexOf('.') > 0) {\r\n    //     //   const longSplit = this.longitude.toString()\r\n    //     //       .split('.');\r\n    //     //   if (longSplit.length >= 2) {\r\n    //     //     long = parseFloat(longSplit[0] === '' ? 0 : longSplit[0]) + parseFloat('.' + longSplit[1].slice(0, 6));\r\n    //     //   }\r\n    //     // }\r\n    //     // if (this.latitude.toString()\r\n    //     //     .indexOf('.') > 0) {\r\n    //     //   const latSplit = this.latitude.toString()\r\n    //     //       .split('.');\r\n    //     //   if (latSplit.length >= 2) {\r\n    //     //     lat = parseFloat(latSplit[0] === '' ? 0 : latSplit[0]) + parseFloat('.' + latSplit[1].slice(0, 6));\r\n    //     //   }\r\n    //     // }\r\n    //     // cookie.set(\"longitude\", long);\r\n    //     // cookie.set(\"latitude\", lat);\r\n    //     // console.log('纬度', lat);\r\n    //     // this.distance(this.latitude,this.longitude);\r\n    //     this.markers = [{\r\n    //       id: '0',\r\n    //       latitude: res.latitude,\r\n    //       longitude: res.longitude,\r\n    //       iconPath: '../../static/location_icon.png',\r\n    //       width: this.markerHeight, //宽\r\n    //       height: this.markerHeight, //高\r\n    //     },];\r\n    //     this.getPositionInfoByAddress('昆明同德广场');\r\n    //   },\r\n    // });\r\n  };\r\n\r\n  //路线规划\r\n  routePolylinePlan({ from, to }, mode = 'driving') {\r\n    //调用距离计算接口\r\n    this.$qqmapsdk.direction({\r\n      mode,//可选值：'driving'（驾车）、'walking'（步行）、'bicycling'（骑行），不填默认：'driving',可不填\r\n      //from参数不填默认当前地址\r\n      from,\r\n      to,\r\n      success: (res) => {\r\n        debugger\r\n        console.log(res);\r\n        // var ret = res;\r\n        // var coors = ret.result.routes[0].polyline,\r\n        //     pl = [];\r\n        // //坐标解压（返回的点串坐标，通过前向差分进行压缩）\r\n        // var kr = 1000000;\r\n        // for (var i = 2; i < coors.length; i++) {\r\n        //   coors[i] = Number(coors[i - 2]) + Number(coors[i]) / kr;\r\n        // }\r\n        // //将解压后的坐标放入点串数组pl中\r\n        // for (var i = 0; i < coors.length; i += 2) {\r\n        //   pl.push({\r\n        //     latitude: coors[i],\r\n        //     longitude: coors[i + 1]\r\n        //   });\r\n        // }\r\n        // console.log(pl);\r\n        //设置polyline属性，将路线显示出来,将解压坐标第一个数据作为起点\r\n        // _this.setData({\r\n        //   latitude:pl[0].latitude,\r\n        //   longitude:pl[0].longitude,\r\n        //   polyline: [{\r\n        //     points: pl,\r\n        //     color: '#FF0000DD',\r\n        //     width: 4\r\n        //   }]\r\n        // })\r\n      },\r\n      fail: (error) => {\r\n        console.error(error);\r\n      },\r\n      complete: (res) => {\r\n        console.log(res);\r\n      }\r\n    });\r\n  }\r\n\r\n  onReady() {\r\n    //   wx请求获取位置权限\r\n    this.getAuthorize('scope.userLocation')\r\n        .then(() => {\r\n          //   同意后获取\r\n          this.getLocationInfo();\r\n          // const _locationChangeFn = function (res) {\r\n          //   debugger\r\n          //   console.log('location change', res);\r\n          // };\r\n          // wx.onLocationChange(_locationChangeFn);\r\n          // wx.offLocationChange(_locationChangeFn);\r\n          // this.$qqmapsdk.search({\r\n          //   keyword: '酒店',\r\n          //   success: function (res) {\r\n          //     debugger\r\n          //     console.log(res);\r\n          //   },\r\n          //   fail: function (res) {\r\n          //     console.log(res);\r\n          //   },\r\n          //   complete: function (res) {\r\n          //     console.log(res);\r\n          //   }\r\n          // });\r\n        })\r\n        .catch(() => {\r\n          //   不同意给出弹框，再次确认\r\n          this.openConfirm()\r\n              .then(() => {\r\n                this.getLocationInfo();\r\n              })\r\n              .catch(() => {\r\n                this.rejectGetLocation();\r\n              });\r\n        });\r\n  }\r\n\r\n}\r\n"],"sourceRoot":""}